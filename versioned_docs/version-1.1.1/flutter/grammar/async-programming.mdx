---
sidebar_position: 4
toc_max_heading_level: 4
---

# ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°
## Async Programming
ê¸°ì¡´ì˜ cpuì˜ ë™ì‘ì€ ì‹¤í–‰í•œ ì½”ë“œê°€ ìˆìœ¼ë©´ í•´ë‹¹ ì½”ë“œê°€ ì‹¤í–‰ì´ ë  ë•Œê¹Œì§€ ë‹¤ìŒ ë™ì‘ì„ ì‹¤í–‰í•  ìˆ˜ ì—†ì—ˆìŒ.<br></br>
ì´ëŠ” http ìš”ì²­ ê°™ì€ ì‘ì—…ì„ í•  ë•Œ ë¬¸ì œê°€ ë°œìƒí•˜ëŠ”ë°, ì„œë²„ì—ì„œ ìš”ì²­ê°’ì„ ë°›ì•„ì˜¤ê¸° ì „ê¹Œì§€ cpuê°€ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ë™ì‘ì´ ì•„ë¬´ê²ƒë„ ì—†ì–´ì§„ë‹¤ëŠ” ë¬¸ì œì ì´ ë°œìƒí•¨.<br></br>
ë‹¤ìŒì€ ê¸°ì¡´ cpuì˜ ë™ì‘ ë°©ì‹ ğŸ‘‡<br></br>
![cpu_work](./img/cpu_work.jpg)<br></br><br></br>
ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ ë“±ì¥í•œ ë°©ì‹ì´ ë°”ë¡œ Async Programmingì¸ë°, **ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°**ì´ë¼ê³ ë„ ë¶ˆë¦¬ë©° í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ ë™ì‘ì´ ì™„ë£Œë˜ì§€ ì•Šë”ë¼ë„ ë‹¤ìŒ ë™ì‘ì„ ì‹¤í–‰í•˜ëŠ” ê²ƒì„ ëœ»í•¨.<br></br>
![asynchronous.jpes](./img/asynchronous.jpeg)<br></br>

## Future and await
Future ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ì •ì˜í•  ìˆ˜ ìˆìœ¼ë©°, Future ê´€ë ¨ method ë“±ì„ ì¨ì¤„ ìˆ˜ ìˆìŒ.<br></br>
```dart
Future<returnType> functionName(Parameter1, Parameter2...) async {
```
### Future.delayed
ì²« íŒŒë¼ë¯¸í„°ì—ëŠ” ì§€ì—°í•  ê¸°ê°„(ì–¼ë§ˆë‚˜ ì§€ì—°í• ê±´ì§€) Duration ê°’ì„ ë„£ì–´ì£¼ê³  ë‘ ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì—ëŠ” ì§€ì—°ì‹œê°„ì´ ì§€ë‚œ í›„ ì‹¤í–‰í•  í•¨ìˆ˜ë¥¼ ë„£ì–´ì¤Œ.
```dart
Future.delayed(Duration(seconds: ), () {}
```
### await 
awaitì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„  í•¨ìˆ˜ì—ë‹¤ê°€ asyncë¥¼ ì¶”ê°€í•´ì•¼ì§€ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ. 
```dart
void main() async {
	await ì‹¤í–‰í• í•¨ìˆ˜();
}
```
### thenê³¼ WhenComplete
thenì€ ì˜¤ë¥˜ê°€ ìˆì„ ê²½ìš°ì— ì‹¤í–‰ì„ ì•ˆí•˜ê³  WhenCompleteì€ ì˜¤ë¥˜ê°€ ìˆì„ ê²½ìš°ì—ë„ ì‹¤í–‰ì„ í•¨.
```dart 
void main() async {
  await futureAsync().then((value) {
    print("Then"); // ì¶œë ¥ ì•ˆë¨
  }).whenComplete(() {
    print("WhenComplete"); // ì¶œë ¥
  });
}

Future futureAsync() async {
  return Future.error("error");
}
```

### ConnectionState
FutureBuilderì˜ ì²˜ë¦¬ ìƒíƒœì— ë”°ë¼ì„œ ì–´ë–¤ ì¡°ê±´ì„ ë„£ê³  ìˆ˜í–‰í•´ì¤„ ìˆ˜ ìˆìŒ.<br></br>

- ì•„ë˜ì™€ ê°™ì€ í˜•íƒœë¡œ ì‚¬ìš©í•¨.

```dart 
snapshot.connectionState
```

- Stateì˜ ì¢…ë¥˜ 

```dart
enum ConnectionState {
	none, // Future ìƒíƒœê°€ ì—†ìŒ.
	waiting, // Future ì‹¤í–‰ í›„ ë¡œë”© ì¤‘.
	// Streamì—ì„œ í•˜ë‚˜ ì´ìƒì˜ return ê°’ì„ ë°˜í™˜ í–ˆì§€ë§Œ ì•„ì§ ì™„ì „íˆ ëë‚˜ì§€ ì•Šì•˜ì„ ë•Œ	
	active, 	
	done, // Future ì‹¤í–‰ ì™„ë£Œ.
}
```

#### Future ë³‘ë ¬ë¡œ ë°ì´í„° ì²˜ë¦¬í•˜ê¸°
Futureë“¤ì„ Listì— ë„£ì–´ì¤€ ë’¤ Listë¥¼ í•œêº¼ë²ˆì— .wait()í•´ì„œ ë°ì´í„°ë¥¼ ë°›ì•„ì¤Œ.<br></br>
Futureë¥¼ í•˜ë‚˜í•˜ë‚˜ ì‹¤í–‰ì‹œí‚¤ê³  ê¸°ë‹¤ë¦¬ëŠ” ê²ƒì´ ì•„ë‹Œ, Futureë¥¼ ëª¨ë‘ ë™ì‹œì— ì‹¤í–‰ì‹œí‚¤ê³  ì „ë¶€ ëë‚  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì„œ ì‹œê°„ì„ ë‹¨ì¶•ì‹œí‚¬ ìˆ˜ ìˆìŒ.
```dart
List<Future> futures = [];

for(ItemCode itemCode in ItemCode.values) {
  futures.add(
    StatRepository.fetchData(
    itemCode: itemCode,
    ),
  );
}
// futuresì— ë“¤ì–´ìˆëŠ” ëª¨ë“  Futureì´ ì‹¤í–‰ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼
// í•´ë‹¹ Future ì‹¤í–‰ê²°ê³¼ ê°’, ì¦‰, List<StatModel>ì´ ë“¤ì–´ê°
final results = await Future.wait(futures);
```

#### Future and await ì°¸ì¡°
[Future and await ì°¸ì¡° 1](https://github.com/rookedsysc/Flutter-Study/blob/main/Grammar/asyncProgramming/future.dart)<br></br>
[Future and await ì°¸ì¡° 2](https://github.com/rookedsysc/Flutter-Study/blob/main/Grammar/asyncProgramming/await.dart)



### Stream
ë¦¬ìŠ¤ë„ˆë¥¼ ìƒì„±í•´ì„œ ë¦¬ìŠ¤ë„ˆê°€ ë¦¬ìŠ¤ë‹ì„ í•˜ê³  ìˆëŠ” ë™ì•ˆ controllerê°€ ê°’ì„ ë„£ì–´ì£¼ë©´ í•¨ìˆ˜ê°€ ì‹¤í–‰ë¨. <br></br>
ì´ ë•Œ return ë˜ëŠ” ê°’ë“¤ì„ ì§€ì†ì ìœ¼ë¡œ ë°˜í™˜í•´ì¤Œ.<br></br>
![Stream](./img/stream.png)
```dart
StreamBuilderBuilder<generic> {
	stream: ì‹¤í–‰í•  í•¨ìˆ˜
}

Stream<generic> ì‹¤í–‰í•  í•¨ìˆ˜() async* {
	yield ë°˜í™˜ ê°’;
}
```

### aysnc*
streamì„ ì‚¬ìš©í•  ë•Œ ì‚¬ìš©í•´ì¤˜ì•¼ í•˜ëŠ” í‚¤ì›Œë“œ, ì—°ì‚°ì„ ë¯¸ë¦¬ ë‹¤ í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼, ìš”ì²­ì´ ìˆì„ ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ë‹¤ê°€ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ê·¸ ë•Œ ì—°ì‚°ì„ ì‹œì‘í•˜ëŠ” ê²ƒì´ë¼ê³  í•¨.
### yield
returnê³¼ ìœ ì‚¬í•œ í–‰ìœ„ë¥¼ í•˜ì§€ë§Œ í•¨ìˆ˜ë¥¼ ì¢…ë£Œí•˜ì§€ ì•Šê³  ë°˜ë³µë˜ëŠ” return ê°’ë“¤ì„ ì „ë¶€ return í•´ì¤„ ìˆ˜ ìˆìŒ.

### ì˜ˆì‹œ 

```dart
import 'dart:async';

void main() {
  final controller = StreamController();
  // asBroadcastStreamì„ ì´ìš©í•´ì¤˜ì•¼ ì—¬ëŸ¬ë²ˆ listeningì„ í•  ìˆ˜ ìˆìŒ.
  final Stream = controller.stream.asBroadcastStream();

  // ì§ìˆ˜ë§Œ ì¶œë ¥
  // ë¦¬ìŠ¤ë„ˆ ìƒì„±, ì´ ë¦¬ìŠ¤ë„ˆê°€ ë¦¬ìŠ¤ë‹ì„ í•˜ê³  ìˆì„ ë•Œ ê°’ì´ ë“¤ì–´ì˜¤ë©´ í•¨ìˆ˜ê°€ ì‹¤í–‰ë¨.
  final streamListener1 = Stream.where((val) => val % 2 == 0).listen((val) {
    print('Listener1 : $val');
  });

  // í™€ìˆ˜ë§Œ ì¶œë ¥
  final streamListener2 = Stream.where((val) => val % 2 == 1).listen((val) {
    print('Listener2 : $val');
  });

  // controllerë¥¼ í†µí•´ì„œ ë¦¬ìŠ¤ë„ˆì— ê°’ì„ ë„£ì–´ì¤Œ
  controller.sink.add(1);
  controller.sink.add(2);
  controller.sink.add(3);
  controller.sink.add(4);
}
```

#### Reference
[ì°¸ì¡° 1](https://github.com/rookedsysc/Flutter-Study/blob/main/Grammar/asyncProgramming/test.dart)<br></br>
[ì°¸ì¡° 2](https://github.com/rookedsysc/Flutter-Study/blob/main/Grammar/asyncProgramming/test3.dart)<br></br>
[ì°¸ì¡° 3](https://github.com/rookedsysc/Flutter-Study/tree/main/Theory/future_and_stream_builder)
