---
sidebar_position: 1
toc_max_heading_level: 4
---

# Go Router

```mdx-code-block
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
```

êµ¬ê¸€ í”ŒëŸ¬í„° íŒ€ì—ì„œ [ê³µì‹ìœ¼ë¡œ ì§€ì›](https://pub.dev/packages/go_router)í•˜ëŠ” íŒ¨í‚¤ì§€<br></br>[Documentation](https://docs.page/csells/go_router)

## Initalization

<Tabs>
<TabItem value="Widget build(){}">

```dart 
// ê¸°ì¡´ì˜ MaterialAppì— .routeë¥¼ ì¶”ê°€í•´ì¤Œ 
MaterialApp.router(
  // 3.2 ë²„ì „ ì´í›„ë¡œ ì‚¬ìš©í•´ì¤˜ì•¼ í•¨
  // ë¼ìš°íŠ¸ ì •ë³´ë¥¼ ì „ë‹¬í•˜ëŠ” ì—­í• ì„ í•¨
  routeInformationProvider: _router.routeInformationProvider,
  // URI Stringì„ ìƒíƒœ ë° Go Routerì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í˜•íƒœë¡œ ë°˜í™˜í•´ì£¼ëŠ” í•¨ìˆ˜
  routeInformationParser: _router.routeInformationParser,
  // ìœ„ì—ì„œ ë³€ê²½ëœ ê°’ìœ¼ë¡œ ì‹¤ì œë¡œ ì–´ë–¤ ë¼ìš°íŠ¸ë¥¼ ë³´ì—¬ì¤„ì§€ ì •í•˜ëŠ” í•¨ìˆ˜
  routerDelegate: _router.routerDelegate,
);
```

</TabItem>
<TabItem value="GoRouter ì„ ì–¸">

`name`ì—ë‹¤ê°€ ë¼ìš°íŠ¸ ì´ë¦„ì„ ë„£ì–´ì£¼ê³  `goNamed()` í•¨ìˆ˜ë¥¼ í†µí•´ì„œ í•´ë‹¹ ë¼ìš°íŠ¸ë¡œ ì´ë™í•  ìˆ˜ ìˆìŒ. ê·¸ë¦¬ê³  `Route ì•ˆì— Route`ë¥¼ ì§€ì •í•´ì£¼ë©´ `nesting`ì´ ê°€ëŠ¥í•¨.
```dart
final _router = GoRouter(
// í™ˆìŠ¤í¬ë¦°
initialLocation: '/',
  routes: [
    GoRoute(
      path: '/',
      // stateì—ëŠ” íŒŒë¼ë¯¸í„°ê°€ ë“¤ì–´ìˆìŒ
      builder: (_, state) => HomeScreen(),
        routes: [
          GoRoute(
              // nesting : ë¼ìš°íŠ¸ ì•ˆì— ë¼ìš°íŠ¸ ë„£ì„ ë•ŒëŠ” '/'ë¥¼ ë¹¼ë„ ë¨
            path: 'one',
            builder: (_, state) => OneScreen(),
            // http://..../one/twoì™€ ê°™ì€ í˜•ì‹ìœ¼ë¡œ nestingë¨
            routes: [
              GoRoute(
                  path: 'two',
                  builder: (_, state) => TwoScreen(),
                  // http://..../one/two/threeì™€ ê°™ì€ í˜•ì‹ìœ¼ë¡œ nestingë¨
                  routes: [
                    GoRoute(
                      path: 'three',
                      name: ThreeScreen.routeName,
                      builder: (_, state) => ThreeScreen(),
                  ),
                ],
              ),
          ],
        ),
      ],
    ),
  ],
)
```

</TabItem>
</Tabs>

## í˜ì´ì§€ ì´ë™

### Push
```dart
// namedPush
context.goNamed(ThreeScreen.routeName);
// stack push
context.go('/one/two/three'); 
```

go routerë¥¼ ì´ìš©í•´ì„œ nestingëœ í˜ì´ì§€ë¥¼ push í•˜ê²Œ ë˜ë©´ ìƒìœ„ í˜ì´ì§€ë“¤ì´ ìŠ¤íƒì²˜ëŸ¼ ìŒ“ì´ê²Œ ë¨.<br></br>
<div style={{textAlign: "center"}}>
<img src={require("./img/go-router/go_router_push.gif").default} style={{width: 300}}/>
</div>

### Pop
```dart
context.pop();
```

## GoRouterë¥¼ í†µí•œ ì¸ì¦ë¡œì§ êµ¬í˜„

### UserModel
```dart
class UserModel {
  final String name;
  UserModel({required this.name});
}
```

### Providerì— GoRouterë¥¼ ì„ ì–¸

```dart
final routerProvider = Provider<GoRouter>((ref) {
  final authStateProvider = AuthNotifier(ref: ref);

  return GoRouter(
      // í™ˆìŠ¤í¬ë¦°
      initialLocation: '/login',
      // í™”ë©´ í‘¸ì‰¬ê°€ ì¼ì–´ë‚  ë•Œë§ˆë‹¤ í˜¸ì¶œë˜ëŠ” ë¡œì§ 
      // refreshì™€ëŠ” ë‹¤ë¥´ê²Œ í™”ë©´ í‘¸ì‰¬ê°€ ìˆì„ ë•Œ ë§ˆë‹¤ í˜¸ì¶œ ë˜ë¯€ë¡œ 
      // refreshListenableì„ í•¨ê»˜ ì¨ì¤˜ì•¼ í•¨
      redirect: authStateProvider._redirectLogic,
      // ìƒíƒœê°€ ë°”ë€Œì—ˆì„ ë•Œë§ˆë‹¤ redirectë¥¼ ì¬ì‹¤í–‰í•´ì¤Œ
      //
      // ì˜ˆë¥¼ ë“¤ì–´,
      // ì¤‘ê°„ì— í† í°ì´ ë§Œë£Œë˜ì—ˆì„ ë•Œ login í™”ë©´ìœ¼ë¡œ ì´ë™
      refreshListenable: authStateProvider,
      // ë„¤ì´ê²Œì´ì…˜ ê³¼ì • ì¤‘ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ ë•Œ
      // stateì— ì—ëŸ¬ ë©”ì‹œì§€ê°€ ë“¤ì–´ê°€ê³ 
      // ErrScreenìœ¼ë¡œ ì´ë™
      errorBuilder: (_, state) => ErrScreen(err: state.error.toString()),
      routes: authStateProvider._routes);
});
```

:::warning Redirect Logic ì¤‘ìš”!!!
```dart
class AuthNotifier extends ChangeNotifier {
  final Ref ref;
  AuthNotifier({required this.ref}) { // refë¥¼ ì™¸ë¶€ì—ì„œ ë°›ì•„ì˜´
    // user modelì˜ ê°’ì´ ë°”ë€Œë©´ call back í•¨ìˆ˜ë¥¼ ì‹¤í–‰
    ref.listen<UserModel?>(
      userProvider,
      (previous, next) {
        if (previous != next) {
          // notifyListeners()ë¥¼ í˜¸ì¶œí•˜ë©´ ChangeNotifierë¥¼ ë°”ë¼ë³´ê³  ìˆëŠ” ëª¨ë“  ìœ„ì ¯ë“¤ì´ ë‹¤ ë¦¬ë¹Œë“œ ë¨
          notifyListeners();
        }
      },
    );
  }

  // redirect logic
  // GoRouterState : í˜„ì¬ ë¼ìš°íŠ¸ì˜ ìƒíƒœ
  String? _redirectLogic(GoRouterState state) {
    final user = ref.read(userProvider); // instance or null
    // ë¡œê·¸ì¸ì„ í•˜ë ¤ëŠ” ìƒíƒœì¸ì§€
    final logginIn = state.location == '/login';

    // ìœ ì € ì •ë³´ê°€ ì—†ë‹¤ - ë¡œê·¸ì¸í•œ ìƒíƒœê°€ ì•„ë‹ˆë‹¤
    //
    // ìœ ì € ì •ë³´ê°€ ì—†ê³ 
    // ë¡œê·¸ì¸í•˜ë ¤ëŠ” ì¤‘ì´ ì•„ë‹ˆë¼ë©´
    // ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•œë‹¤.
    if (user == null) {
      // redirectì— ë„£ì—ˆì„ ë•Œ
      //
      // logginInì´ trueë©´ ì›ë˜ ê°€ë ¤ë˜ í˜ì´ì§€ë¡œ ì´ë™
      // falseë©´ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
      return logginIn ? null : '/login';
    }

    // ìœ ì € ì •ë³´ê°€ ìˆëŠ”ë°
    // ë¡œê·¸ì¸ í˜ì´ì§€ì¼ ë•Œ í™ˆìœ¼ë¡œ ì´ë™
    if (logginIn) {
      return '/';
    }

    return null;
  }

  List<GoRoute> get _routes => [
        GoRoute(
          path: '/',
          builder: (_, state) => HomeScreen(),
          routes: [
            GoRoute(
              // nesting : ë¼ìš°íŠ¸ ì•ˆì— ë¼ìš°íŠ¸ ë„£ì„ ë•ŒëŠ” '/'ë¥¼ ë¹¼ë„ ë¨
              path: 'one',
              builder: (_, state) => OneScreen(),
              // http://..../one/twoì™€ ê°™ì€ í˜•ì‹ìœ¼ë¡œ nestingë¨
              routes: [
                GoRoute(
                  path: 'two',
                  builder: (_, state) => TwoScreen(),
                  routes: [
                    GoRoute(
                      path: 'three',
                      name: ThreeScreen.routeName,
                      builder: (_, state) => ThreeScreen(),
                    ),
                  ],
                ),
              ],
            ),
          ],
        ),
        GoRoute(path: '/login', builder: (_, state) => LoginScreen()),
      ];
}
```
:::

ë‹¤ìŒê³¼ ê°™ì´ GoRouterë¥¼ Providerì— ì„ ì–¸í•´ì£¼ê³  _App(mainì—ì„œ ìµœì´ˆ ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜)ë¥¼ ConsumerWidgetìœ¼ë¡œ ë³€ê²½í•˜ê³  Refë¥¼ í†µí•´ì„œ router ì„¤ì •ì„ ë„£ì–´ì¤Œ.

```dart 
class _App extends ConsumerWidget {
  const _App({super.key});
  @override
  Widget build(BuildContext context, WidgetRef ref) {
    // routerProvider Watch 
    final router = ref.watch(routerProvider);
    return MaterialApp.router(
      // watchí•œ provider ê°€ì§€ê³  config í˜•ì„±
      routeInformationProvider: router.routeInformationProvider,
      routeInformationParser: router.routeInformationParser,
      routerDelegate: router.routerDelegate,
    );
  }
}
```

### ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ êµ¬í˜„

```dart title="user State AuthNotifier"
final userProvider =
    StateNotifierProvider<UserStateNotifier, UserModel?>((ref) {
  return UserStateNotifier();
});

// ë¡œê·¸ì¸ ì‹œì—ëŠ” user nameì„, ë¡œê·¸ì•„ì›ƒ ì‹œì—ëŠ” nullì„ stateë¡œ ê°€ì§€ëŠ” StateNotifier
class UserStateNotifier extends StateNotifier<UserModel?> {
  UserStateNotifier() : super(null);

  login(String name) {
    state = UserModel(name: name);
  }

  logout() {
    state = null;
  }
}
```

## Error

### No Such Method Error
ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ëŠ” ì˜ëª»ëœ contextì—ì„œ go routerë¥¼ ë¶ˆëŸ¬ì˜¤ê³  ìˆê¸° ë•Œë¬¸ì— ë°œìƒí•˜ëŠ” ì—ëŸ¬ì„.
:::warning
ì˜ˆì™¸ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.<br></br>
NoSuchMethodError (NoSuchMethodError: Class 'SliverMultiBoxAdaptorElement' has no instance method 'goNamed'.<br></br>
Receiver: Instance of 'SliverMultiBoxAdaptorElement'<br></br>
Tried calling: goNamed("restaruantDetail", params: _LinkedHashMap len:1))
:::

ì•„ë˜ì˜ ì˜ˆì œì—ì„œëŠ” PaginationListViewì˜ itemBuilderì˜ contextì—ì„œ goNamedë¥¼ ë¶ˆëŸ¬ì˜¤ê³  ìˆìŒ.

<div style={{textAlign: "center"}}>
<img src={require("./img/go-router/no_such_method_error.png").default}/>
</div>

ë”°ë¼ì„œ ë‹¤ìŒì˜ contextë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•´ì£¼ë©´

<div style={{textAlign: "center"}}>
<img src={require("./img/go-router/no_such_method_error_solve_1.png").default}/>
</div>

ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆìŒ. ğŸ‘‡ <br></br>

<div style={{textAlign: "center"}}>
<img src={require("./img/go-router/no_such_method_error_solve_2.gif").default}/>
</div>


